<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>口腔機能低下症 診断・管理アプリ</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Helvetica Neue', Arial, sans-serif;
    }
    
    body {
      margin: 0;
      padding: 20px;
      background-color: #f5f7fa;
      color: #333;
      line-height: 1.6;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 20px;
    }
    
    header {
      text-align: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid #eee;
    }
    
    h1 {
      color: #2c3e50;
      margin: 0;
      padding: 10px 0;
    }
    
    h2 {
      color: #3498db;
      border-left: 5px solid #3498db;
      padding-left: 10px;
      margin-top: 30px;
    }
    
    h3 {
      color: #555;
      margin-top: 20px;
      border-bottom: 1px dashed #ddd;
      padding-bottom: 5px;
    }
    
    .tabs {
      display: flex;
      border-bottom: 1px solid #ddd;
      margin-bottom: 20px;
    }
    
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border: 1px solid transparent;
      border-bottom: none;
      border-radius: 4px 4px 0 0;
      margin-right: 5px;
      background: #f8f9fa;
      font-weight: bold;
    }
    
    .tab.active {
      background: #fff;
      border-color: #ddd;
      border-bottom-color: #fff;
      margin-bottom: -1px;
      color: #3498db;
    }
    
    .tab-content {
      display: none;
      padding: 20px;
      background: #fff;
      border-radius: 0 0 4px 4px;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    
    input[type="text"],
    input[type="number"],
    input[type="date"],
    select,
    textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
    }
    
    .input-group {
      display: flex;
      align-items: center;
    }
    
    .input-group input {
      flex: 1;
      margin-right: 10px;
    }
    
    .input-group-append {
      white-space: nowrap;
    }
    
    button {
      background: #3498db;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
    }
    
    button:hover {
      background: #2980b9;
    }
    
    .btn-secondary {
      background: #95a5a6;
    }
    
    .btn-secondary:hover {
      background: #7f8c8d;
    }
    
    .btn-success {
      background: #2ecc71;
    }
    
    .btn-success:hover {
      background: #27ae60;
    }
    
    .btn-danger {
      background: #e74c3c;
    }
    
    .btn-danger:hover {
      background: #c0392b;
    }
    
    .result-box {
      margin-top: 20px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 4px;
      border-left: 5px solid #3498db;
    }
    
    .result-positive {
      border-left-color: #e74c3c;
      background: #fdedec;
    }
    
    .result-negative {
      border-left-color: #2ecc71;
      background: #eafaf1;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    
    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: left;
    }
    
    th {
      background: #f8f9fa;
      font-weight: bold;
    }
    
    tr:nth-child(even) {
      background: #f9f9f9;
    }
    
    .summary-card {
      background: white;
      border-radius: 4px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-bottom: 20px;
      padding: 15px;
    }
    
    .check-group {
      margin-bottom: 10px;
    }
    
    .checkbox-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }
    
    .checkbox-item {
      display: flex;
      align-items: center;
      background: #f8f9fa;
      padding: 8px 15px;
      border-radius: 30px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .checkbox-item:hover {
      background: #e9f0f5;
    }
    
    .checkbox-item input {
      margin-right: 8px;
    }
    
    .red-text {
      color: #e74c3c;
      font-weight: bold;
    }
    
    .green-text {
      color: #2ecc71;
      font-weight: bold;
    }
    
    .tooltip {
      position: relative;
      display: inline-block;
      cursor: help;
      margin-left: 5px;
      font-size: 14px;
      color: #3498db;
    }
    
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 300px;
      background-color: #555;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 14px;
      line-height: 1.4;
    }
    
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
    
    @media print {
      .no-print {
        display: none !important;
      }
      
      body, .container {
        background: white;
        padding: 0;
        margin: 0;
        box-shadow: none;
      }
      
      .print-page-break {
        page-break-before: always;
      }
    }
    
    .grid-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }
    
    @media (max-width: 768px) {
      .grid-container {
        grid-template-columns: 1fr;
      }
    }
    
    /* For the tongue coating index */
    .tci-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(3, 1fr);
      gap: 5px;
      width: 300px;
      height: 240px;
      margin: 0 auto 20px auto;
    }
    
    .tci-cell {
      background: #f0f0f0;
      border: 1px solid #ccc;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .tci-cell.score-0 {
      background: #eafaf1;
    }
    
    .tci-cell.score-1 {
      background: #fef9e7;
    }
    
    .tci-cell.score-2 {
      background: #fdedec;
    }
    
    .progress-bar-container {
      width: 100%;
      background-color: #f3f3f3;
      border-radius: 10px;
      margin: 15px 0;
    }
    
    .progress-bar {
      height: 20px;
      background-color: #3498db;
      border-radius: 10px;
      text-align: center;
      color: white;
      font-weight: bold;
      transition: width 0.5s;
    }
    
    /* For rating options */
    .rating-options {
      display: flex;
      gap: 10px;
      margin: 10px 0;
    }
    
    .rating-option {
      flex: 1;
      padding: 10px;
      text-align: center;
      border: 1px solid #ddd;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .rating-option:hover {
      background: #f5f9ff;
    }
    
    .rating-option.selected {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
    
    /* Swallow assessment */
    .eat-10-question {
      background: #f9f9f9;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 4px;
    }
    
    .eat-10-options {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
    
    .eat-10-option {
      text-align: center;
      flex: 1;
      padding: 8px 2px;
      background: #fff;
      border: 1px solid #ddd;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .eat-10-option:first-child {
      border-radius: 4px 0 0 4px;
    }
    
    .eat-10-option:last-child {
      border-radius: 0 4px 4px 0;
    }
    
    .eat-10-option:hover {
      background: #f5f9ff;
    }
    
    .eat-10-option.selected {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
    
    /* For management plan */
    .management-section {
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid #eee;
    }
    
    .management-options {
      display: flex;
      gap: 10px;
      margin: 10px 0;
    }
    
    .management-option {
      flex: 1;
      padding: 10px;
      text-align: center;
      border: 1px solid #ddd;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .management-option:hover {
      background: #f5f9ff;
    }
    
    .management-option.selected {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
    
  </style>
</head>
<body>
  <script>
    // タブ切り替え機能
    function openTab(tabName) {
      // すべてのタブコンテンツを非表示にする
      const tabContents = document.querySelectorAll('.tab-content');
      tabContents.forEach(content => {
        content.classList.remove('active');
      });
      
      // すべてのタブを非アクティブにする
      const tabs = document.querySelectorAll('.tab');
      tabs.forEach(tab => {
        tab.classList.remove('active');
      });
      
      // 選択したタブとコンテンツをアクティブにする
      document.getElementById(tabName).classList.add('active');
      document.querySelector(`.tab[onclick="openTab('${tabName}')"]`).classList.add('active');
    }
    
    // BMI計算機能
    function calculateBMI() {
      const height = parseFloat(document.getElementById('height').value) / 100; // cmからmに変換
      const weight = parseFloat(document.getElementById('weight').value);
      
      if (height > 0 && weight > 0) {
        const bmi = (weight / (height * height)).toFixed(1);
        document.getElementById('bmi').value = bmi;
      } else {
        alert('身長と体重を正しく入力してください');
      }
    }
    
    // 患者情報の表示/非表示を切り替える関数
    function toggleMedicationDetails() {
      const medicationStatus = document.getElementById('medication-status').value;
      const medicationDetails = document.getElementById('medication-details');
      
      if (medicationStatus === 'yes') {
        medicationDetails.style.display = 'block';
      } else {
        medicationDetails.style.display = 'none';
      }
    }
    
    function toggleWeightChangeDetails() {
      const weightChange = document.getElementById('weight-change').value;
      const weightChangeDetails = document.getElementById('weight-change-details');
      
      if (weightChange === 'yes') {
        weightChangeDetails.style.display = 'block';
      } else {
        weightChangeDetails.style.display = 'none';
      }
    }
    
    function toggleFoodFormOther() {
      const foodForm = document.getElementById('food-form').value;
      const foodFormOther = document.getElementById('food-form-other');
      
      if (foodForm === 'other') {
        foodFormOther.style.display = 'block';
      } else {
        foodFormOther.style.display = 'none';
      }
    }
    
    function toggleAppetiteReason() {
      const appetite = document.getElementById('appetite').value;
      const appetiteReason = document.getElementById('appetite-reason');
      
      if (appetite === 'no') {
        appetiteReason.style.display = 'block';
      } else {
        appetiteReason.style.display = 'none';
      }
    }
    
    // 患者情報保存関数
    function savePatientInfo() {
      alert('患者情報が保存されました');
    }
    
    // イベントリスナーの追加
    window.addEventListener('load', function() {
      // 各セレクト要素にイベントリスナーを追加
      document.getElementById('medication-status').addEventListener('change', toggleMedicationDetails);
      document.getElementById('weight-change').addEventListener('change', toggleWeightChangeDetails);
      document.getElementById('food-form').addEventListener('change', toggleFoodFormOther);
      document.getElementById('appetite').addEventListener('change', toggleAppetiteReason);
    });
    
    // 口腔機能精密検査のJavaScript関数
    
    // 評価項目のステータス管理
    const assessmentStatus = {
      tci: false,
      dryness: false,
      biteForce: false,
      oralDiadochokinesis: false,
      tonguePressure: false,
      mastication: false,
      swallowing: false
    };
    
    // 進捗バーを更新する関数
    function updateProgress() {
      const completedItems = Object.values(assessmentStatus).filter(status => status).length;
      const progressPercent = (completedItems / 7) * 100;
      
      document.getElementById('assessment-progress').style.width = `${progressPercent}%`;
      document.getElementById('assessment-progress').textContent = `${completedItems}/7項目完了`;
    }
    
    // TCI評価機能
    function setTCIScore(cell, index) {
      const currentScore = parseInt(cell.getAttribute('data-score'));
      let newScore = 0;
      
      // スコアの順番: 0 -> 1 -> 2 -> 0
      if (currentScore === 0) {
        newScore = 1;
        cell.classList.remove('score-0');
        cell.classList.add('score-1');
      } else if (currentScore === 1) {
        newScore = 2;
        cell.classList.remove('score-1');
        cell.classList.add('score-2');
      } else if (currentScore === 2) {
        newScore = 0;
        cell.classList.remove('score-2');
        cell.classList.add('score-0');
      }
      
      cell.setAttribute('data-score', newScore);
      cell.textContent = newScore;
      
      // TCI値を計算して表示
      calculateTCI();
    }
    
    function calculateTCI() {
      const cells = document.querySelectorAll('.tci-cell');
      let totalScore = 0;
      
      cells.forEach(cell => {
        totalScore += parseInt(cell.getAttribute('data-score'));
      });
      
      // TCI値 = スコアの合計 / 最大スコア(18) * 100
      const tciValue = Math.round((totalScore / 18) * 100);
      document.getElementById('tci-value').textContent = tciValue;
      
      // 判定結果を表示
      const resultElement = document.getElementById('tci-result');
      if (tciValue >= 50) {
        resultElement.innerHTML = `<p class="red-text">判定結果: 口腔衛生状態不良あり（TCI値: ${tciValue}%）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.tci = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 口腔衛生状態不良なし（TCI値: ${tciValue}%）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.tci = false;
      }
      
      updateProgress();
    }
    
    // 口腔乾燥の評価方法選択
    function toggleDrynessMethod() {
      const method = document.getElementById('dryness-method').value;
      
      if (method === 'moisture') {
        document.getElementById('moisture-method').style.display = 'block';
        document.getElementById('saliva-method').style.display = 'none';
      } else if (method === 'saliva') {
        document.getElementById('moisture-method').style.display = 'none';
        document.getElementById('saliva-method').style.display = 'block';
      } else {
        document.getElementById('moisture-method').style.display = 'none';
        document.getElementById('saliva-method').style.display = 'none';
      }
    }
    
    // 口腔粘膜湿潤度の評価
    function evaluateMoisture() {
      const value = parseFloat(document.getElementById('moisture-value').value);
      const resultElement = document.getElementById('moisture-result');
      
      if (isNaN(value)) {
        alert('数値を入力してください');
        return;
      }
      
      if (value < 27.0) {
        resultElement.innerHTML = `<p class="red-text">判定結果: 口腔乾燥あり（${value}）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.dryness = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 口腔乾燥なし（${value}）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.dryness = false;
      }
      
      updateProgress();
    }
    
    // 唾液量の評価
    function evaluateSaliva() {
      const value = parseFloat(document.getElementById('saliva-value').value);
      const resultElement = document.getElementById('saliva-result');
      
      if (isNaN(value)) {
        alert('数値を入力してください');
        return;
      }
      
      if (value <= 2.0) {
        resultElement.innerHTML = `<p class="red-text">判定結果: 口腔乾燥あり（${value}g/2分）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.dryness = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 口腔乾燥なし（${value}g/2分）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.dryness = false;
      }
      
      updateProgress();
    }
    
    // 咬合力低下の評価方法選択
    function toggleBiteForceMethod() {
      const method = document.getElementById('bite-force-method').value;
      
      if (method === 'force') {
        document.getElementById('force-method').style.display = 'block';
        document.getElementById('teeth-method').style.display = 'none';
      } else if (method === 'teeth') {
        document.getElementById('force-method').style.display = 'none';
        document.getElementById('teeth-method').style.display = 'block';
      } else {
        document.getElementById('force-method').style.display = 'none';
        document.getElementById('teeth-method').style.display = 'none';
      }
    }
    
    // 咬合力測定システムに応じた基準値の更新
    function updateForceThreshold() {
      const system = document.getElementById('force-system').value;
      let threshold = '';
      
      if (system === 'dental-scale-2-filter') {
        threshold = '350N未満';
      } else if (system === 'dental-scale-2-no-filter') {
        threshold = '500N未満';
      } else if (system === 'dental-scale') {
        threshold = '200N未満';
      } else if (system === 'oramo-bf') {
        threshold = '375N未満';
      } else {
        threshold = '選択してください';
      }
      
      document.getElementById('force-threshold').textContent = threshold;
    }
    
    // 咬合力の評価
    function evaluateBiteForce() {
      const system = document.getElementById('force-system').value;
      const value = parseFloat(document.getElementById('force-value').value);
      const resultElement = document.getElementById('force-result');
      
      if (system === '') {
        alert('測定システムを選択してください');
        return;
      }
      
      if (isNaN(value)) {
        alert('数値を入力してください');
        return;
      }
      
      let threshold = 0;
      if (system === 'dental-scale-2-filter') {
        threshold = 350;
      } else if (system === 'dental-scale-2-no-filter') {
        threshold = 500;
      } else if (system === 'dental-scale') {
        threshold = 200;
      } else if (system === 'oramo-bf') {
        threshold = 375;
      }
      
      if (value < threshold) {
        resultElement.innerHTML = `<p class="red-text">判定結果: 咬合力低下あり（${value}N）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.biteForce = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 咬合力低下なし（${value}N）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.biteForce = false;
      }
      
      updateProgress();
    }
    
    // 残存歯数の評価
    function evaluateTeethCount() {
      const count = parseInt(document.getElementById('teeth-count').value);
      const resultElement = document.getElementById('teeth-result');
      
      if (isNaN(count)) {
        alert('数値を入力してください');
        return;
      }
      
      if (count < 20) {
        resultElement.innerHTML = `<p class="red-text">判定結果: 咬合力低下あり（残存歯数: ${count}本）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.biteForce = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 咬合力低下なし（残存歯数: ${count}本）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.biteForce = false;
      }
      
      updateProgress();
    }
    
    // オーラルディアドコキネシスの評価
    function evaluateOralDiadochokinesis() {
      const paValue = parseFloat(document.getElementById('pa-value').value);
      const taValue = parseFloat(document.getElementById('ta-value').value);
      const kaValue = parseFloat(document.getElementById('ka-value').value);
      const resultElement = document.getElementById('oral-diadochokinesis-result');
      
      if (isNaN(paValue) || isNaN(taValue) || isNaN(kaValue)) {
        alert('すべての数値を入力してください');
        return;
      }
      
      const hasLowFunction = paValue < 6 || taValue < 6 || kaValue < 6;
      
      if (hasLowFunction) {
        let lowValues = [];
        if (paValue < 6) lowValues.push(`「パ」: ${paValue}回/秒`);
        if (taValue < 6) lowValues.push(`「タ」: ${taValue}回/秒`);
        if (kaValue < 6) lowValues.push(`「カ」: ${kaValue}回/秒`);
        
        resultElement.innerHTML = `<p class="red-text">判定結果: 舌口唇運動機能低下あり（${lowValues.join('、')}）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.oralDiadochokinesis = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 舌口唇運動機能低下なし（「パ」: ${paValue}回/秒、「タ」: ${taValue}回/秒、「カ」: ${kaValue}回/秒）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.oralDiadochokinesis = false;
      }
      
      updateProgress();
    }
    
    // 舌圧の評価
    function evaluateTonguePressure() {
      const pressure = parseFloat(document.getElementById('tongue-pressure').value);
      const resultElement = document.getElementById('tongue-pressure-result');
      
      if (isNaN(pressure)) {
        alert('数値を入力してください');
        return;
      }
      
      if (pressure < 30) {
        resultElement.innerHTML = `<p class="red-text">判定結果: 低舌圧あり（${pressure}kPa）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.tonguePressure = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 低舌圧なし（${pressure}kPa）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.tonguePressure = false;
      }
      
      updateProgress();
    }
    
    // 咀嚼機能評価方法の選択
    function toggleMasticationMethod() {
      const method = document.getElementById('mastication-method').value;
      
      if (method === 'glucose') {
        document.getElementById('glucose-method').style.display = 'block';
        document.getElementById('score-method').style.display = 'none';
      } else if (method === 'score') {
        document.getElementById('glucose-method').style.display = 'none';
        document.getElementById('score-method').style.display = 'block';
      } else {
        document.getElementById('glucose-method').style.display = 'none';
        document.getElementById('score-method').style.display = 'none';
      }
    }
    
    // グルコース溶出量の評価
    function evaluateGlucose() {
      const value = parseFloat(document.getElementById('glucose-value').value);
      const resultElement = document.getElementById('glucose-result');
      
      if (isNaN(value)) {
        alert('数値を入力してください');
        return;
      }
      
      if (value < 100) {
        resultElement.innerHTML = `<p class="red-text">判定結果: 咀嚼機能低下あり（${value}mg/dL）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.mastication = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 咀嚼機能低下なし（${value}mg/dL）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.mastication = false;
      }
      
      updateProgress();
    }
    
    // 咀嚼能率スコアの評価
    function evaluateMasticationScore() {
      const score = document.getElementById('mastication-score').value;
      const resultElement = document.getElementById('mastication-score-result');
      
      if (score === '') {
        alert('スコアを選択してください');
        return;
      }
      
      const scoreValue = parseInt(score);
      
      if (scoreValue <= 2) {
        resultElement.innerHTML = `<p class="red-text">判定結果: 咀嚼機能低下あり（スコア${scoreValue}）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.mastication = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 咀嚼機能低下なし（スコア${scoreValue}）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.mastication = false;
      }
      
      updateProgress();
    }
    
    // 嚥下機能評価方法の選択
    function toggleSwallowingMethod() {
      const method = document.getElementById('swallowing-method').value;
      
      if (method === 'eat10') {
        document.getElementById('eat10-method').style.display = 'block';
        document.getElementById('seirei-method').style.display = 'none';
      } else if (method === 'seirei') {
        document.getElementById('eat10-method').style.display = 'none';
        document.getElementById('seirei-method').style.display = 'block';
      } else {
        document.getElementById('eat10-method').style.display = 'none';
        document.getElementById('seirei-method').style.display = 'none';
      }
    }
    
    // EAT-10の回答を選択
    let eat10Scores = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    
    function selectEAT10Option(element, questionIndex) {
      // 同じ質問の他のオプションから選択クラスを削除
      const options = element.parentElement.querySelectorAll('.eat-10-option');
      options.forEach(option => {
        option.classList.remove('selected');
      });
      
      // 選択されたオプションに選択クラスを追加
      element.classList.add('selected');
      
      // スコアを保存
      eat10Scores[questionIndex] = parseInt(element.getAttribute('data-value'));
      
      // 総スコアを計算して表示
      evaluateEAT10();
    }
    
    // EAT-10の評価
    function evaluateEAT10() {
      const totalScore = eat10Scores.reduce((sum, score) => sum + score, 0);
      const resultElement = document.getElementById('eat10-result');
      
      if (totalScore >= 3) {
        resultElement.innerHTML = `<p class="red-text">判定結果: 嚥下機能低下あり（EAT-10スコア: ${totalScore}点）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.swallowing = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 嚥下機能低下なし（EAT-10スコア: ${totalScore}点）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.swallowing = false;
      }
      
      updateProgress();
    }
    
    // 聖隷式嚥下質問紙の評価
    function evaluateSeireiQuestionnaire() {
      const hasTypeA = document.querySelector('input.seirei-typeA:checked') !== null;
      const resultElement = document.getElementById('seirei-result');
      
      if (hasTypeA) {
        resultElement.innerHTML = `<p class="red-text">判定結果: 嚥下機能低下あり（Aの回答あり）</p>`;
        resultElement.classList.add('result-positive');
        resultElement.classList.remove('result-negative');
        assessmentStatus.swallowing = true;
      } else {
        resultElement.innerHTML = `<p class="green-text">判定結果: 嚥下機能低下なし（Aの回答なし）</p>`;
        resultElement.classList.add('result-negative');
        resultElement.classList.remove('result-positive');
        assessmentStatus.swallowing = false;
      }
      
      updateProgress();
    }
    
    // 診断結果の表示
function showDiagnosis() {
  const completedItems = Object.values(assessmentStatus).filter(status => status).length;
  const diagnosisElement = document.getElementById('diagnosis-result');
  const detailsElement = document.getElementById('diagnosis-details');
  
  // 診断結果の表示
  if (completedItems >= 3) {
    diagnosisElement.innerHTML = `
      <div class="result-box result-positive">
        <h3>診断結果: 口腔機能低下症</h3>
        <p>7項目中${completedItems}項目が基準値を下回っています。</p>
      </div>
    `;
  } else {
    diagnosisElement.innerHTML = `
      <div class="result-box result-negative">
        <h3>診断結果: 口腔機能低下症ではありません</h3>
        <p>7項目中${completedItems}項目が基準値を下回っています（3項目未満）。</p>
      </div>
    `;
  }
  
  // 評価項目の詳細テーブルを更新
  detailsElement.innerHTML = '';
  
  // 口腔衛生状態不良(TCI)
  if (document.getElementById('tci-value')) {
    const tciValue = document.getElementById('tci-value').textContent;
    const tciStatus = assessmentStatus.tci;
    detailsElement.innerHTML += `
      <tr>
        <td>① 口腔衛生状態不良</td>
        <td>TCI値: ${tciValue}%</td>
        <td>50%以上</td>
        <td>${tciStatus ? '<span class="red-text">該当</span>' : '<span class="green-text">非該当</span>'}</td>
      </tr>
    `;
  }
  
  // 口腔乾燥
  if (assessmentStatus.dryness !== undefined) {
    let drynessValue = '';
    if (document.getElementById('moisture-value') && document.getElementById('moisture-value').value) {
      drynessValue = `湿潤度: ${document.getElementById('moisture-value').value}`;
    } else if (document.getElementById('saliva-value') && document.getElementById('saliva-value').value) {
      drynessValue = `唾液量: ${document.getElementById('saliva-value').value}g/2分`;
    }
    
    detailsElement.innerHTML += `
      <tr>
        <td>② 口腔乾燥</td>
        <td>${drynessValue}</td>
        <td>湿潤度27.0未満または唾液量2g/2分以下</td>
        <td>${assessmentStatus.dryness ? '<span class="red-text">該当</span>' : '<span class="green-text">非該当</span>'}</td>
      </tr>
    `;
  }
  
  // 咬合力低下
  if (assessmentStatus.biteForce !== undefined) {
    let biteForceValue = '';
    if (document.getElementById('force-value') && document.getElementById('force-value').value) {
      biteForceValue = `咬合力: ${document.getElementById('force-value').value}N`;
    } else if (document.getElementById('teeth-count') && document.getElementById('teeth-count').value) {
      biteForceValue = `残存歯数: ${document.getElementById('teeth-count').value}本`;
    }
    
    detailsElement.innerHTML += `
      <tr>
        <td>③ 咬合力低下</td>
        <td>${biteForceValue}</td>
        <td>咬合力350N未満または残存歯数20本未満</td>
        <td>${assessmentStatus.biteForce ? '<span class="red-text">該当</span>' : '<span class="green-text">非該当</span>'}</td>
      </tr>
    `;
  }
  
  // 舌口唇運動機能低下
  if (assessmentStatus.oralDiadochokinesis !== undefined && 
      document.getElementById('pa-value') && 
      document.getElementById('ta-value') && 
      document.getElementById('ka-value')) {
    const paValue = document.getElementById('pa-value').value;
    const taValue = document.getElementById('ta-value').value;
    const kaValue = document.getElementById('ka-value').value;
    
    detailsElement.innerHTML += `
      <tr>
        <td>④ 舌口唇運動機能低下</td>
        <td>パ: ${paValue}回/秒, タ: ${taValue}回/秒, カ: ${kaValue}回/秒</td>
        <td>いずれかが6回/秒未満</td>
        <td>${assessmentStatus.oralDiadochokinesis ? '<span class="red-text">該当</span>' : '<span class="green-text">非該当</span>'}</td>
      </tr>
    `;
  }
  
  // 低舌圧
  if (assessmentStatus.tonguePressure !== undefined && document.getElementById('tongue-pressure')) {
    const tonguePressure = document.getElementById('tongue-pressure').value;
    
    detailsElement.innerHTML += `
      <tr>
        <td>⑤ 低舌圧</td>
        <td>${tonguePressure}kPa</td>
        <td>30kPa未満</td>
        <td>${assessmentStatus.tonguePressure ? '<span class="red-text">該当</span>' : '<span class="green-text">非該当</span>'}</td>
      </tr>
    `;
  }
  
  // 咀嚼機能低下
  if (assessmentStatus.mastication !== undefined) {
    let masticationValue = '';
    if (document.getElementById('glucose-value') && document.getElementById('glucose-value').value) {
      masticationValue = `グルコース濃度: ${document.getElementById('glucose-value').value}mg/dL`;
    } else if (document.getElementById('mastication-score') && document.getElementById('mastication-score').value) {
      masticationValue = `咀嚼能率スコア: ${document.getElementById('mastication-score').value}`;
    }
    
    detailsElement.innerHTML += `
      <tr>
        <td>⑥ 咀嚼機能低下</td>
        <td>${masticationValue}</td>
        <td>グルコース濃度100mg/dL未満またはスコア2以下</td>
        <td>${assessmentStatus.mastication ? '<span class="red-text">該当</span>' : '<span class="green-text">非該当</span>'}</td>
      </tr>
    `;
  }
  
  // 嚥下機能低下
  if (assessmentStatus.swallowing !== undefined) {
    let swallowingValue = '';
    if (document.getElementById('eat10-result') && document.getElementById('eat10-result').textContent.includes('EAT-10')) {
      const match = document.getElementById('eat10-result').textContent.match(/EAT-10スコア: (\d+)点/);
      if (match) {
        swallowingValue = `EAT-10スコア: ${match[1]}点`;
      } else {
        swallowingValue = 'EAT-10評価実施';
      }
    } else if (document.getElementById('seirei-result')) {
      swallowingValue = '聖隷式嚥下質問紙評価実施';
    }
    
    detailsElement.innerHTML += `
      <tr>
        <td>⑦ 嚥下機能低下</td>
        <td>${swallowingValue}</td>
        <td>EAT-10で3点以上または聖隷式質問紙でAの回答あり</td>
        <td>${assessmentStatus.swallowing ? '<span class="red-text">該当</span>' : '<span class="green-text">非該当</span>'}</td>
      </tr>
    `;
  }
}
  </script>
  <div class="container">
    <header>
      <h1>口腔機能低下症 診断・管理アプリ</h1>
      <p>日本老年歯科医学会の基準に基づく診断・管理ツール</p>
      <div style="margin-top: 10px;">
        <button onclick="window.print()" class="btn-secondary no-print">印刷</button>
        <button onclick="saveAllData()" class="btn-success no-print">データ保存</button>
      </div>
    </header>
    
    <div class="tabs no-print">
      <div class="tab active" onclick="openTab('patient-info')">患者情報</div>
      <div class="tab" onclick="openTab('assessment')">口腔機能精密検査</div>
      <div class="tab" onclick="openTab('diagnosis')">診断結果</div>
      <div class="tab" onclick="openTab('management-plan')">管理計画書</div>
      <div class="tab" onclick="openTab('progress-record')">管理指導記録簿</div>
      <div class="tab" onclick="openTab('information')">参考情報</div>
    </div>
    
    <!-- Patient Information Tab -->
    <div id="patient-info" class="tab-content active">
      <h2>患者基本情報</h2>
      <div class="grid-container">
        <div class="form-group">
          <label for="patient-name">患者氏名</label>
          <input type="text" id="patient-name" placeholder="例：山田 太郎">
        </div>
        <div class="form-group">
          <label for="patient-id">患者ID</label>
          <input type="text" id="patient-id" placeholder="例：P12345">
        </div>
        <div class="form-group">
          <label for="patient-kana">フリガナ</label>
          <input type="text" id="patient-kana" placeholder="例：ヤマダ タロウ">
        </div>
        <div class="form-group">
          <label for="birthdate">生年月日</label>
          <input type="date" id="birthdate">
        </div>
        <div class="form-group">
          <label for="gender">性別</label>
          <select id="gender">
            <option value="">選択してください</option>
            <option value="male">男性</option>
            <option value="female">女性</option>
          </select>
        </div>
        <div class="form-group">
          <label for="assessment-date">検査日</label>
          <input type="date" id="assessment-date">
        </div>
      </div>
      
      <h2>全身の状態</h2>
      <div class="grid-container">
        <div class="form-group">
          <label>基礎疾患</label>
          <div class="checkbox-container">
            <label class="checkbox-item">
              <input type="checkbox" name="disease" value="heart"> 心疾患
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="disease" value="hepatitis"> 肝炎
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="disease" value="diabetes"> 糖尿病
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="disease" value="hypertension"> 高血圧症
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="disease" value="stroke"> 脳血管疾患
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="disease" value="other"> その他
            </label>
          </div>
        </div>
        <div class="form-group">
          <label for="medication">服用薬剤</label>
          <select id="medication-status">
            <option value="no">なし</option>
            <option value="yes">あり</option>
          </select>
          <div id="medication-details" style="margin-top: 10px; display: none;">
            <textarea id="medication-list" placeholder="薬剤名をご記入ください"></textarea>
          </div>
        </div>
        
        <div class="form-group">
          <label for="pneumonia-history">肺炎の既往</label>
          <select id="pneumonia-history">
            <option value="no">なし</option>
            <option value="yes">あり</option>
            <option value="repeated">繰り返しあり</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="height">身長 (cm)</label>
          <input type="number" id="height" placeholder="例：165">
        </div>
        
        <div class="form-group">
          <label for="weight">体重 (kg)</label>
          <input type="number" id="weight" placeholder="例：60">
        </div>
        
        <div class="form-group">
          <label for="bmi">BMI</label>
          <div class="input-group">
            <input type="text" id="bmi" readonly>
            <div class="input-group-append">
              <button type="button" onclick="calculateBMI()">計算</button>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label for="weight-change">体重の変化</label>
          <select id="weight-change">
            <option value="no">なし</option>
            <option value="yes">あり</option>
          </select>
          <div id="weight-change-details" style="margin-top: 10px; display: none;">
            <div class="input-group">
              <input type="number" id="weight-change-months" placeholder="期間(月)" style="width: 100px;">
              <span style="margin: 0 10px;">ヶ月で</span>
              <input type="number" id="weight-change-amount" placeholder="変化量(kg)" style="width: 100px;">
              <span style="margin: 0 10px;">kgの</span>
              <select id="weight-change-direction" style="width: 100px;">
                <option value="increase">増加</option>
                <option value="decrease">減少</option>
              </select>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label for="food-form">食事形態</label>
          <select id="food-form">
            <option value="normal">常食</option>
            <option value="soft">やわらかい食事</option>
            <option value="other">その他</option>
          </select>
          <div id="food-form-other" style="margin-top: 10px; display: none;">
            <input type="text" id="food-form-other-text" placeholder="その他の食事形態をご記入ください">
          </div>
        </div>
        
        <div class="form-group">
          <label for="appetite">食欲</label>
          <select id="appetite">
            <option value="yes">あり</option>
            <option value="no">なし</option>
          </select>
          <div id="appetite-reason" style="margin-top: 10px; display: none;">
            <input type="text" id="appetite-reason-text" placeholder="食欲がない理由をご記入ください">
          </div>
        </div>
      </div>
      
      <div class="form-group" style="margin-top: 30px;">
        <button onclick="savePatientInfo()" class="btn-success">患者情報を保存</button>
        <button onclick="openTab('assessment')" style="margin-left: 10px;">口腔機能精密検査へ進む</button>
      </div>
    </div>
    
    <!-- Assessment Tab -->
    <div id="assessment" class="tab-content">
     <h2>口腔機能精密検査</h2>
     <p>各項目の評価を行ってください。3項目以上が基準値を下回る場合、口腔機能低下症と診断されます。</p>
  
     <div class="progress-bar-container">
     <div id="assessment-progress" class="progress-bar" style="width: 0%;">0/7項目完了</div>
     </div>
     <!-- 1. 口腔衛生状態不良の評価 -->
     <div class="summary-card">
     <h3>① 口腔衛生状態不良の評価 <span class="tooltip">ⓘ<span class="tooltiptext">視診により Tongue Coating Index (TCI) を用いて、舌苔の付着程度を評価します。50%以上で「口腔衛生状態不良」と判定されます。</span></span></h3>
    
     <div>
       <p>舌表面を9分割し、それぞれのエリアに対して舌苔の付着程度を評価します。</p>
       <p>0：舌苔なし、1：薄い舌苔あり、2：厚い舌苔あり</p>
      
       <div class="tci-grid">
        <div class="tci-cell" data-score="0" onclick="setTCIScore(this, 0)">0</div>
        <div class="tci-cell" data-score="0" onclick="setTCIScore(this, 1)">0</div>
        <div class="tci-cell" data-score="0" onclick="setTCIScore(this, 2)">0</div>
        <div class="tci-cell" data-score="0" onclick="setTCIScore(this, 3)">0</div>
        <div class="tci-cell" data-score="0" onclick="setTCIScore(this, 4)">0</div>
        <div class="tci-cell" data-score="0" onclick="setTCIScore(this, 5)">0</div>
        <div class="tci-cell" data-score="0" onclick="setTCIScore(this, 6)">0</div>
        <div class="tci-cell" data-score="0" onclick="setTCIScore(this, 7)">0</div>
        <div class="tci-cell" data-score="0" onclick="setTCIScore(this, 8)">0</div>
       </div>
      
       <p>TCI値: <span id="tci-value">0</span>% (基準値: 50%以上)</p>
       <div class="result-box" id="tci-result">
        判定結果: まだ評価されていません
      </div>
    </div>
     </div>

     <!-- 2. 口腔乾燥の評価 -->
     <div class="summary-card">
    <h3>② 口腔乾燥の評価 <span class="tooltip">ⓘ<span class="tooltiptext">口腔粘膜湿潤度または唾液量で評価します。どちらかの評価方法を選択してください。</span></span></h3>
    
    <div class="form-group">
      <label>評価方法の選択:</label>
      <select id="dryness-method" onchange="toggleDrynessMethod()">
        <option value="">選択してください</option>
        <option value="moisture">口腔粘膜湿潤度</option>
        <option value="saliva">唾液量（サクソンテスト）</option>
      </select>
    </div>
    
    <div id="moisture-method" style="display:none;">
      <p>口腔水分計（ムーカス）または口腔湿潤計を使用して計測します。</p>
      <div class="form-group">
        <label for="moisture-value">口腔粘膜湿潤度:</label>
        <div class="input-group">
          <input type="number" id="moisture-value" step="0.1" min="0" placeholder="例：25.5">
          <button onclick="evaluateMoisture()">評価</button>
        </div>
        <p>基準値: 27.0未満</p>
      </div>
      <div class="result-box" id="moisture-result">
        判定結果: まだ評価されていません
      </div>
    </div>
    
    <div id="saliva-method" style="display:none;">
      <p>サクソンテストによる唾液量の計測です。</p>
      <div class="form-group">
        <label for="saliva-value">唾液量 (2分間の重量増加):</label>
        <div class="input-group">
          <input type="number" id="saliva-value" step="0.1" min="0" placeholder="例：1.8">
          <span class="input-group-append">g</span>
          <button onclick="evaluateSaliva()">評価</button>
        </div>
        <p>基準値: 2g/2分以下</p>
      </div>
      <div class="result-box" id="saliva-result">
        判定結果: まだ評価されていません
      </div>
    </div>
     </div>
  
     <!-- 3. 咬合力低下の評価 -->
     <div class="summary-card">
    <h3>③ 咬合力低下の評価 <span class="tooltip">ⓘ<span class="tooltiptext">咬合力検査または残存歯数により評価します。咬合力検査を優先します。</span></span></h3>
    
    <div class="form-group">
      <label>評価方法の選択:</label>
      <select id="bite-force-method" onchange="toggleBiteForceMethod()">
        <option value="">選択してください</option>
        <option value="force">咬合力検査</option>
        <option value="teeth">残存歯数</option>
      </select>
    </div>
    
    <div id="force-method" style="display:none;">
      <p>歯科用咬合力計を用いて計測します。</p>
      <div class="form-group">
        <label for="force-system">使用する測定システム:</label>
        <select id="force-system" onchange="updateForceThreshold()">
          <option value="">選択してください</option>
          <option value="dental-scale-2-filter">デンタルプレスケールⅡ（フィルタあり）</option>
          <option value="dental-scale-2-no-filter">デンタルプレスケールⅡ（フィルタなし）</option>
          <option value="dental-scale">デンタルプレスケール</option>
          <option value="oramo-bf">口腔機能モニター (Oramo-bf)</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="force-value">咬合力:</label>
        <div class="input-group">
          <input type="number" id="force-value" min="0" placeholder="例：300">
          <span class="input-group-append">N</span>
          <button onclick="evaluateBiteForce()">評価</button>
        </div>
        <p>基準値: <span id="force-threshold">選択してください</span></p>
      </div>
      <div class="result-box" id="force-result">
        判定結果: まだ評価されていません
      </div>
    </div>
    
    <div id="teeth-method" style="display:none;">
      <p>残存歯数を計測します。残根と動揺度3の歯を除きます。</p>
      <div class="form-group">
        <label for="teeth-count">残存歯数:</label>
        <div class="input-group">
          <input type="number" id="teeth-count" min="0" max="32" placeholder="例：18">
          <span class="input-group-append">本</span>
          <button onclick="evaluateTeethCount()">評価</button>
        </div>
        <p>基準値: 20本未満</p>
      </div>
      <div class="result-box" id="teeth-result">
        判定結果: まだ評価されていません
      </div>
    </div>
     </div>
  
     <!-- 4. 舌口唇運動機能低下の評価 -->
     <div class="summary-card">
    <h3>④ 舌口唇運動機能低下の評価 <span class="tooltip">ⓘ<span class="tooltiptext">オーラルディアドコキネシスにより評価します。/pa/、/ta/、/ka/それぞれの音節の5秒間での発音回数を計測します。</span></span></h3>
    
    <p>「パ」「タ」「カ」それぞれを5秒間できるだけ速く繰り返し発音してもらい、1秒あたりの回数を計測します。</p>
    
    <div class="grid-container">
      <div class="form-group">
        <label for="pa-value">「パ」の回数:</label>
        <div class="input-group">
          <input type="number" id="pa-value" step="0.1" min="0" placeholder="例：5.8">
          <span class="input-group-append">回/秒</span>
        </div>
      </div>
      
      <div class="form-group">
        <label for="ta-value">「タ」の回数:</label>
        <div class="input-group">
          <input type="number" id="ta-value" step="0.1" min="0" placeholder="例：5.5">
          <span class="input-group-append">回/秒</span>
        </div>
      </div>
      
      <div class="form-group">
        <label for="ka-value">「カ」の回数:</label>
        <div class="input-group">
          <input type="number" id="ka-value" step="0.1" min="0" placeholder="例：5.2">
          <span class="input-group-append">回/秒</span>
        </div>
      </div>
    </div>
    
    <button onclick="evaluateOralDiadochokinesis()">評価する</button>
    
    <div class="result-box" id="oral-diadochokinesis-result">
      判定結果: まだ評価されていません
    </div>
     </div>
  
     <!-- 5. 低舌圧の評価 -->
     <div class="summary-card">
    <h3>⑤ 低舌圧の評価 <span class="tooltip">ⓘ<span class="tooltiptext">舌圧測定器により最大舌圧を計測します。30kPa未満を低舌圧とします。</span></span></h3>
    
    <p>舌圧測定器（JMS舌圧測定器など）を使用して、最大舌圧を計測します。</p>
    
    <div class="form-group">
      <label for="tongue-pressure">舌圧:</label>
      <div class="input-group">
        <input type="number" id="tongue-pressure" step="0.1" min="0" placeholder="例：28.5">
        <span class="input-group-append">kPa</span>
        <button onclick="evaluateTonguePressure()">評価</button>
      </div>
      <p>基準値: 30kPa未満</p>
    </div>
    
    <div class="result-box" id="tongue-pressure-result">
      判定結果: まだ評価されていません
    </div>
     </div>
  
     <!-- 6. 咀嚼機能低下の評価 -->
     <div class="summary-card">
    <h3>⑥ 咀嚼機能低下の評価 <span class="tooltip">ⓘ<span class="tooltiptext">咀嚼能力検査または咀嚼能率スコア法により評価します。誤嚥・誤飲のリスクを考慮して実施してください。</span></span></h3>
    
    <div class="form-group">
      <label>評価方法の選択:</label>
      <select id="mastication-method" onchange="toggleMasticationMethod()">
        <option value="">選択してください</option>
        <option value="glucose">咀嚼能力検査（グルコース溶出量）</option>
        <option value="score">咀嚼能率スコア法</option>
      </select>
    </div>
    
    <div id="glucose-method" style="display:none;">
      <p>グルコセンサーを用いたグルコース溶出量による咀嚼能率検査です。</p>
      <div class="form-group">
        <label for="glucose-value">グルコース濃度:</label>
        <div class="input-group">
          <input type="number" id="glucose-value" min="0" placeholder="例：85">
          <span class="input-group-append">mg/dL</span>
          <button onclick="evaluateGlucose()">評価</button>
        </div>
        <p>基準値: 100mg/dL未満</p>
      </div>
      <div class="result-box" id="glucose-result">
        判定結果: まだ評価されていません
      </div>
    </div>
    
    <div id="score-method" style="display:none;">
      <p>咀嚼能率スコア法による評価です。グミゼリーを30回咀嚼後の粉砕度を視覚的に評価します。</p>
      <div class="form-group">
        <label for="mastication-score">咀嚼能率スコア:</label>
        <select id="mastication-score">
          <option value="">選択してください</option>
          <option value="0">スコア0（粉砕なし）</option>
          <option value="1">スコア1（わずかに粉砕）</option>
          <option value="2">スコア2（粉砕あり）</option>
          <option value="3">スコア3（半分程度粉砕）</option>
          <option value="4">スコア4（大部分粉砕）</option>
          <option value="5">スコア5（完全に粉砕）</option>
        </select>
        <button onclick="evaluateMasticationScore()" style="margin-top: 10px;">評価</button>
      </div>
      <p>基準値: スコア2以下</p>
      <div class="result-box" id="mastication-score-result">
        判定結果: まだ評価されていません
      </div>
    </div>
     </div>
  
     <!-- 7. 嚥下機能低下の評価 -->
     <div class="summary-card">
    <h3>⑦ 嚥下機能低下の評価 <span class="tooltip">ⓘ<span class="tooltiptext">嚥下スクリーニング検査（EAT-10）または自記式質問票（聖隷式嚥下質問紙）により評価します。</span></span></h3>
    
    <div class="form-group">
      <label>評価方法の選択:</label>
      <select id="swallowing-method" onchange="toggleSwallowingMethod()">
        <option value="">選択してください</option>
        <option value="eat10">嚥下スクリーニング検査（EAT-10）</option>
        <option value="seirei">自記式質問票（聖隷式嚥下質問紙）</option>
      </select>
    </div>
    
    <div id="eat10-method" style="display:none;">
      <p>嚥下スクリーニング質問紙（EAT-10）による評価です。</p>
      <p>各質問に対して、「0: 問題なし」から「4: ひどく問題」の5段階で回答してください。</p>
      
      <div class="eat-10-question">
        <p>1. 飲み込むときに、むせることがある。</p>
        <div class="eat-10-options">
          <div class="eat-10-option" data-value="0" onclick="selectEAT10Option(this, 0)">0：問題なし</div>
          <div class="eat-10-option" data-value="1" onclick="selectEAT10Option(this, 0)">1</div>
          <div class="eat-10-option" data-value="2" onclick="selectEAT10Option(this, 0)">2</div>
          <div class="eat-10-option" data-value="3" onclick="selectEAT10Option(this, 0)">3</div>
          <div class="eat-10-option" data-value="4" onclick="selectEAT10Option(this, 0)">4：ひどく問題</div>
        </div>
      </div>
      
      <div class="eat-10-question">
        <p>2. のどに食べ物がひっかかる感じがする。</p>
        <div class="eat-10-options">
          <div class="eat-10-option" data-value="0" onclick="selectEAT10Option(this, 1)">0：問題なし</div>
          <div class="eat-10-option" data-value="1" onclick="selectEAT10Option(this, 1)">1</div>
          <div class="eat-10-option" data-value="2" onclick="selectEAT10Option(this, 1)">2</div>
          <div class="eat-10-option" data-value="3" onclick="selectEAT10Option(this, 1)">3</div>
          <div class="eat-10-option" data-value="4" onclick="selectEAT10Option(this, 1)">4：ひどく問題</div>
        </div>
      </div>
      
      <div class="eat-10-question">
        <p>3. 食事中によだれがでる。</p>
        <div class="eat-10-options">
          <div class="eat-10-option" data-value="0" onclick="selectEAT10Option(this, 2)">0：問題なし</div>
          <div class="eat-10-option" data-value="1" onclick="selectEAT10Option(this, 2)">1</div>
          <div class="eat-10-option" data-value="2" onclick="selectEAT10Option(this, 2)">2</div>
          <div class="eat-10-option" data-value="3" onclick="selectEAT10Option(this, 2)">3</div>
          <div class="eat-10-option" data-value="4" onclick="selectEAT10Option(this, 2)">4：ひどく問題</div>
        </div>
      </div>
      
      <div class="eat-10-question">
        <p>4. 口から食べ物がこぼれる。</p>
        <div class="eat-10-options">
          <div class="eat-10-option" data-value="0" onclick="selectEAT10Option(this, 3)">0：問題なし</div>
          <div class="eat-10-option" data-value="1" onclick="selectEAT10Option(this, 3)">1</div>
          <div class="eat-10-option" data-value="2" onclick="selectEAT10Option(this, 3)">2</div>
          <div class="eat-10-option" data-value="3" onclick="selectEAT10Option(this, 3)">3</div>
          <div class="eat-10-option" data-value="4" onclick="selectEAT10Option(this, 3)">4：ひどく問題</div>
        </div>
      </div>
      
      <div class="eat-10-question">
        <p>5. 唾を飲み込むのがむずかしい。</p>
        <div class="eat-10-options">
          <div class="eat-10-option" data-value="0" onclick="selectEAT10Option(this, 4)">0：問題なし</div>
          <div class="eat-10-option" data-value="1" onclick="selectEAT10Option(this, 4)">1</div>
          <div class="eat-10-option" data-value="2" onclick="selectEAT10Option(this, 4)">2</div>
          <div class="eat-10-option" data-value="3" onclick="selectEAT10Option(this, 4)">3</div>
          <div class="eat-10-option" data-value="4" onclick="selectEAT10Option(this, 4)">4：ひどく問題</div>
        </div>
      </div>
      
      <div class="eat-10-question">
        <p>6. 固形物を飲み込むのがむずかしい。</p>
        <div class="eat-10-options">
          <div class="eat-10-option" data-value="0" onclick="selectEAT10Option(this, 5)">0：問題なし</div>
          <div class="eat-10-option" data-value="1" onclick="selectEAT10Option(this, 5)">1</div>
          <div class="eat-10-option" data-value="2" onclick="selectEAT10Option(this, 5)">2</div>
          <div class="eat-10-option" data-value="3" onclick="selectEAT10Option(this, 5)">3</div>
          <div class="eat-10-option" data-value="4" onclick="selectEAT10Option(this, 5)">4：ひどく問題</div>
        </div>
      </div>
      
      <div class="eat-10-question">
        <p>7. 錠剤を飲み込むのがむずかしい。</p>
        <div class="eat-10-options">
          <div class="eat-10-option" data-value="0" onclick="selectEAT10Option(this, 6)">0：問題なし</div>
          <div class="eat-10-option" data-value="1" onclick="selectEAT10Option(this, 6)">1</div>
          <div class="eat-10-option" data-value="2" onclick="selectEAT10Option(this, 6)">2</div>
          <div class="eat-10-option" data-value="3" onclick="selectEAT10Option(this, 6)">3</div>
          <div class="eat-10-option" data-value="4" onclick="selectEAT10Option(this, 6)">4：ひどく問題</div>
        </div>
      </div>
      
      <div class="eat-10-question">
        <p>8. 飲み込むことが苦痛である。</p>
        <div class="eat-10-options">
          <div class="eat-10-option" data-value="0" onclick="selectEAT10Option(this, 7)">0：問題なし</div>
          <div class="eat-10-option" data-value="1" onclick="selectEAT10Option(this, 7)">1</div>
          <div class="eat-10-option" data-value="2" onclick="selectEAT10Option(this, 7)">2</div>
          <div class="eat-10-option" data-value="3" onclick="selectEAT10Option(this, 7)">3</div>
          <div class="eat-10-option" data-value="4" onclick="selectEAT10Option(this, 7)">4：ひどく問題</div>
        </div>
      </div>
      
      <div class="eat-10-question">
        <p>9. 飲食時にせきがでる。</p>
        <div class="eat-10-options">
          <div class="eat-10-option" data-value="0" onclick="selectEAT10Option(this, 8)">0：問題なし</div>
          <div class="eat-10-option" data-value="1" onclick="selectEAT10Option(this, 8)">1</div>
          <div class="eat-10-option" data-value="2" onclick="selectEAT10Option(this, 8)">2</div>
          <div class="eat-10-option" data-value="3" onclick="selectEAT10Option(this, 8)">3</div>
          <div class="eat-10-option" data-value="4" onclick="selectEAT10Option(this, 8)">4：ひどく問題</div>
        </div>
      </div>
      
      <div class="eat-10-question">
        <p>10. 飲み込み後、声がかすれる。</p>
        <div class="eat-10-options">
          <div class="eat-10-option" data-value="0" onclick="selectEAT10Option(this, 9)">0：問題なし</div>
          <div class="eat-10-option" data-value="1" onclick="selectEAT10Option(this, 9)">1</div>
          <div class="eat-10-option" data-value="2" onclick="selectEAT10Option(this, 9)">2</div>
          <div class="eat-10-option" data-value="3" onclick="selectEAT10Option(this, 9)">3</div>
          <div class="eat-10-option" data-value="4" onclick="selectEAT10Option(this, 9)">4：ひどく問題</div>
        </div>
      </div>
      
      <div class="result-box" id="eat10-result" style="margin-top: 20px;">
        判定結果: まだ評価されていません
      </div>
    </div>
    
    <div id="seirei-method" style="display:none;">
      <p>聖隷式嚥下質問紙による評価です。</p>
      <p>各質問に対して、A、B、Cのいずれかで回答してください。Aに1つでも該当すると嚥下機能低下と判定します。</p>
      
      <div class="form-group">
        <p>1. お茶や汁物などでむせることがありますか？</p>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q1" value="A" onchange="evaluateSeireiQuestionnaire()" class="seirei-typeA"> A：よくある
        </label>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q1" value="B" onchange="evaluateSeireiQuestionnaire()"> B：時々ある
        </label>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q1" value="C" onchange="evaluateSeireiQuestionnaire()"> C：ない
        </label>
      </div>
      
      <div class="form-group">
        <p>2. 食事中に咳が出ることがありますか？</p>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q2" value="A" onchange="evaluateSeireiQuestionnaire()" class="seirei-typeA"> A：よくある
        </label>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q2" value="B" onchange="evaluateSeireiQuestionnaire()"> B：時々ある
        </label>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q2" value="C" onchange="evaluateSeireiQuestionnaire()"> C：ない
        </label>
      </div>
      
      <div class="form-group">
        <p>3. 食事の途中でよだれがでることがありますか？</p>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q3" value="A" onchange="evaluateSeireiQuestionnaire()" class="seirei-typeA"> A：よくある
        </label>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q3" value="B" onchange="evaluateSeireiQuestionnaire()"> B：時々ある
        </label>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q3" value="C" onchange="evaluateSeireiQuestionnaire()"> C：ない
        </label>
      </div>
      
      <div class="form-group">
        <p>4. 食べ物や唾をのみこむとき、のどに違和感を感じることがありますか？</p>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q4" value="A" onchange="evaluateSeireiQuestionnaire()" class="seirei-typeA"> A：よくある
        </label>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q4" value="B" onchange="evaluateSeireiQuestionnaire()"> B：時々ある
        </label>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q4" value="C" onchange="evaluateSeireiQuestionnaire()"> C：ない
        </label>
      </div>
      
      <div class="form-group">
        <p>5. 食事中や食後に、のどに食べ物が残る感じがすることがありますか？</p>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q5" value="A" onchange="evaluateSeireiQuestionnaire()" class="seirei-typeA"> A：よくある
        </label>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q5" value="B" onchange="evaluateSeireiQuestionnaire()"> B：時々ある
        </label>
        <label class="checkbox-item">
          <input type="radio" name="seirei-q5" value="C" onchange="evaluateSeireiQuestionnaire()"> C：ない
        </label>
      </div>
      
      <div class="result-box" id="seirei-result" style="margin-top: 20px;">
        判定結果: まだ評価されていません
      </div>
    </div>
     </div>
    </div>

    <!-- Diagnosis Tab -->
    <div id="diagnosis" class="tab-content">
      <h2>口腔機能低下症 診断結果</h2>
      
      <div class="summary-card">
        <p>口腔機能精密検査の結果に基づく診断結果です。</p>
        <button onclick="showDiagnosis()" class="btn-success">診断結果を表示</button>
        
        <div id="diagnosis-result" style="margin-top: 20px;">
          <!-- 診断結果がここに表示されます -->
        </div>
        
        <div style="margin-top: 30px;">
          <h3>評価項目の詳細</h3>
          <table>
            <thead>
              <tr>
                <th>評価項目</th>
                <th>検査値</th>
                <th>基準値</th>
                <th>判定</th>
              </tr>
            </thead>
            <tbody id="diagnosis-details">
              <!-- 評価項目の詳細がここに表示されます -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Management Plan Tab -->
    <div id="management-plan" class="tab-content">
      <h2>口腔機能低下症 管理計画書</h2>
      
      <div class="summary-card">
        <h3>全身の状態</h3>
        <div class="grid-container">
          <div class="form-group">
            <label>基礎疾患:</label>
            <p id="mp-disease">選択した基礎疾患がここに表示されます</p>
          </div>
          
          <div class="form-group">
            <label>服用薬剤:</label>
            <p id="mp-medication">服用薬剤情報がここに表示されます</p>
          </div>
          
          <div class="form-group">
            <label>肺炎の既往:</label>
            <p id="mp-pneumonia">肺炎の既往情報がここに表示されます</p>
          </div>
          
          <div class="form-group">
            <label>栄養状態:</label>
            <p id="mp-nutrition">BMI: <span id="mp-bmi"></span></p>
          </div>
          
          <div class="form-group">
            <label>体重の変化:</label>
            <p id="mp-weight-change">体重変化情報がここに表示されます</p>
          </div>
          
          <div class="form-group">
            <label>食事形態:</label>
            <p id="mp-food-form">食事形態情報がここに表示されます</p>
          </div>
          
          <div class="form-group">
            <label>食欲:</label>
            <p id="mp-appetite">食欲情報がここに表示されます</p>
          </div>
        </div>
      </div>
      
      <div class="summary-card">
        <h3>口腔機能の状態</h3>
        <table>
          <thead>
            <tr>
              <th>評価項目</th>
              <th>検査結果</th>
              <th>状態</th>
            </tr>
          </thead>
          <tbody id="mp-oral-function">
            <!-- 口腔機能の状態がここに表示されます -->
            <tr>
              <td>1. 口腔内の衛生状態</td>
              <td id="mp-hygiene-value">-</td>
              <td id="mp-hygiene-status">-</td>
            </tr>
            <tr>
              <td>2. 口腔内の乾燥程度</td>
              <td id="mp-dryness-value">-</td>
              <td id="mp-dryness-status">-</td>
            </tr>
            <tr>
              <td>3. 咬む力の程度</td>
              <td id="mp-bite-value">-</td>
              <td id="mp-bite-status">-</td>
            </tr>
            <tr>
              <td>4. 口唇の動きの程度</td>
              <td id="mp-lip-value">-</td>
              <td id="mp-lip-status">-</td>
            </tr>
            <tr>
              <td>5. 舌尖の動きの程度</td>
              <td id="mp-tongue-tip-value">-</td>
              <td id="mp-tongue-tip-status">-</td>
            </tr>
            <tr>
              <td>6. 奥舌の動きの程度</td>
              <td id="mp-back-tongue-value">-</td>
              <td id="mp-back-tongue-status">-</td>
            </tr>
            <tr>
              <td>7. 舌の力の程度</td>
              <td id="mp-tongue-pressure-value">-</td>
              <td id="mp-tongue-pressure-status">-</td>
            </tr>
            <tr>
              <td>8. 咀嚼の機能の程度</td>
              <td id="mp-mastication-value">-</td>
              <td id="mp-mastication-status">-</td>
            </tr>
            <tr>
              <td>9. 嚥下の機能の程度</td>
              <td id="mp-swallowing-value">-</td>
              <td id="mp-swallowing-status">-</td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div class="summary-card">
        <h3>口腔機能管理計画</h3>
        <table>
          <thead>
            <tr>
              <th>管理項目</th>
              <th>管理方針</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1. 口腔内の衛生</td>
              <td>
                <div class="management-options">
                  <div class="management-option" onclick="selectManagementOption(this, 'hygiene')" data-value="1">問題なし</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'hygiene')" data-value="2">機能維持を目指す</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'hygiene')" data-value="3">機能向上を目指す</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>2. 口腔内の乾燥</td>
              <td>
                <div class="management-options">
                  <div class="management-option" onclick="selectManagementOption(this, 'dryness')" data-value="1">問題なし</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'dryness')" data-value="2">機能維持を目指す</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'dryness')" data-value="3">機能向上を目指す</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>3. 咬む力</td>
              <td>
                <div class="management-options">
                  <div class="management-option" onclick="selectManagementOption(this, 'bite')" data-value="1">問題なし</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'bite')" data-value="2">機能維持を目指す</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'bite')" data-value="3">機能向上を目指す</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>4. 口唇の動き</td>
              <td>
                <div class="management-options">
                  <div class="management-option" onclick="selectManagementOption(this, 'lip')" data-value="1">問題なし</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'lip')" data-value="2">機能維持を目指す</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'lip')" data-value="3">機能向上を目指す</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>5. 舌尖の動き</td>
              <td>
                <div class="management-options">
                  <div class="management-option" onclick="selectManagementOption(this, 'tongue-tip')" data-value="1">問題なし</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'tongue-tip')" data-value="2">機能維持を目指す</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'tongue-tip')" data-value="3">機能向上を目指す</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>6. 奥舌の動き</td>
              <td>
                <div class="management-options">
                  <div class="management-option" onclick="selectManagementOption(this, 'back-tongue')" data-value="1">問題なし</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'back-tongue')" data-value="2">機能維持を目指す</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'back-tongue')" data-value="3">機能向上を目指す</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>7. 舌の力</td>
              <td>
                <div class="management-options">
                  <div class="management-option" onclick="selectManagementOption(this, 'tongue-pressure')" data-value="1">問題なし</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'tongue-pressure')" data-value="2">機能維持を目指す</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'tongue-pressure')" data-value="3">機能向上を目指す</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>8. 咀嚼の機能</td>
              <td>
                <div class="management-options">
                  <div class="management-option" onclick="selectManagementOption(this, 'mastication')" data-value="1">問題なし</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'mastication')" data-value="2">機能維持を目指す</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'mastication')" data-value="3">機能向上を目指す</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>9. 嚥下の機能</td>
              <td>
                <div class="management-options">
                  <div class="management-option" onclick="selectManagementOption(this, 'swallowing')" data-value="1">問題なし</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'swallowing')" data-value="2">機能維持を目指す</div>
                  <div class="management-option" onclick="selectManagementOption(this, 'swallowing')" data-value="3">機能向上を目指す</div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div class="summary-card">
        <h3>管理方針・目標（ゴール）・治療予定等</h3>
        <textarea id="management-goals" style="width: 100%; height: 150px;" placeholder="管理方針や目標、治療予定などを記入してください"></textarea>
      </div>
      
      <div class="summary-card">
        <h3>再評価の時期・治療期間</h3>
        <div class="form-group">
          <label for="reevaluation-period">再評価の時期：約</label>
          <div class="input-group">
            <input type="number" id="reevaluation-period" min="1" value="6" style="width: 100px;">
            <span>か月後</span>
          </div>
        </div>
      </div>
      
      <div class="form-group" style="margin-top: 30px;">
        <button onclick="generateManagementPlan()" class="btn-success">管理計画書を作成</button>
        <button onclick="printManagementPlan()" class="btn-secondary" style="margin-left: 10px;">管理計画書を印刷</button>
      </div>
    </div>
    
    <!-- Progress Record Tab -->
    <div id="progress-record" class="tab-content">
      <h2>口腔機能低下症 管理指導記録簿</h2>
      
      <div class="form-group">
        <label for="record-date">記録日</label>
        <input type="date" id="record-date">
      </div>
      
      <div class="summary-card">
        <h3>評価項目</h3>
        <table>
          <thead>
            <tr>
              <th>評価項目</th>
              <th>評価（1：改善・2：著変なし・3：悪化）</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>栄養・体重</td>
              <td>
                <div class="rating-options">
                  <div class="rating-option" onclick="selectRating(this, 'nutrition')" data-value="1">1：改善</div>
                  <div class="rating-option" onclick="selectRating(this, 'nutrition')" data-value="2">2：著変なし</div>
                  <div class="rating-option" onclick="selectRating(this, 'nutrition')" data-value="3">3：悪化</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>口腔衛生</td>
              <td>
                <div class="rating-options">
                  <div class="rating-option" onclick="selectRating(this, 'hygiene')" data-value="1">1：改善</div>
                  <div class="rating-option" onclick="selectRating(this, 'hygiene')" data-value="2">2：著変なし</div>
                  <div class="rating-option" onclick="selectRating(this, 'hygiene')" data-value="3">3：悪化</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>口腔乾燥</td>
              <td>
                <div class="rating-options">
                  <div class="rating-option" onclick="selectRating(this, 'dryness')" data-value="1">1：改善</div>
                  <div class="rating-option" onclick="selectRating(this, 'dryness')" data-value="2">2：著変なし</div>
                  <div class="rating-option" onclick="selectRating(this, 'dryness')" data-value="3">3：悪化</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>咬合・義歯</td>
              <td>
                <div class="rating-options">
                  <div class="rating-option" onclick="selectRating(this, 'bite')" data-value="1">1：改善</div>
                  <div class="rating-option" onclick="selectRating(this, 'bite')" data-value="2">2：著変なし</div>
                  <div class="rating-option" onclick="selectRating(this, 'bite')" data-value="3">3：悪化</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>口唇機能</td>
              <td>
                <div class="rating-options">
                  <div class="rating-option" onclick="selectRating(this, 'lip')" data-value="1">1：改善</div>
                  <div class="rating-option" onclick="selectRating(this, 'lip')" data-value="2">2：著変なし</div>
                  <div class="rating-option" onclick="selectRating(this, 'lip')" data-value="3">3：悪化</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>舌機能</td>
              <td>
                <div class="rating-options">
                  <div class="rating-option" onclick="selectRating(this, 'tongue')" data-value="1">1：改善</div>
                  <div class="rating-option" onclick="selectRating(this, 'tongue')" data-value="2">2：著変なし</div>
                  <div class="rating-option" onclick="selectRating(this, 'tongue')" data-value="3">3：悪化</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>咀嚼機能</td>
              <td>
                <div class="rating-options">
                  <div class="rating-option" onclick="selectRating(this, 'mastication')" data-value="1">1：改善</div>
                  <div class="rating-option" onclick="selectRating(this, 'mastication')" data-value="2">2：著変なし</div>
                  <div class="rating-option" onclick="selectRating(this, 'mastication')" data-value="3">3：悪化</div>
                </div>
              </td>
            </tr>
            <tr>
              <td>嚥下機能</td>
              <td>
                <div class="rating-options">
                  <div class="rating-option" onclick="selectRating(this, 'swallowing')" data-value="1">1：改善</div>
                  <div class="rating-option" onclick="selectRating(this, 'swallowing')" data-value="2">2：著変なし</div>
                  <div class="rating-option" onclick="selectRating(this, 'swallowing')" data-value="3">3：悪化</div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div class="summary-card">
        <h3>所見</h3>
        <div class="form-group">
          <label for="findings-general">全身状態</label>
          <textarea id="findings-general" style="width: 100%; height: 100px;" placeholder="全身状態に関する所見を記入してください"></textarea>
        </div>
        <div class="form-group">
          <label for="findings-oral">口腔機能</label>
          <textarea id="findings-oral" style="width: 100%; height: 100px;" placeholder="口腔機能に関する所見を記入してください"></textarea>
        </div>
        <div class="form-group">
          <label for="findings-other">その他</label>
          <textarea id="findings-other" style="width: 100%; height: 100px;" placeholder="その他の所見を記入してください"></textarea>
        </div>
      </div>
      
      <div class="summary-card">
        <h3>管理内容</h3>
        <textarea id="management-content" style="width: 100%; height: 150px;" placeholder="実施した管理内容について記入してください"></textarea>
      </div>
      
      <div class="form-group" style="margin-top: 30px;">
        <button onclick="saveProgressRecord()" class="btn-success">管理指導記録を保存</button>
        <button onclick="printProgressRecord()" class="btn-secondary" style="margin-left: 10px;">管理指導記録を印刷</button>
      </div>
    </div>
    
    <!-- Information Tab -->
    <div id="information" class="tab-content">
      <h2>口腔機能低下症に関する参考情報</h2>
      
      <div class="summary-card">
        <h3>口腔機能低下症とは</h3>
        <p>口腔機能低下症は、加齢だけでなく，疾患や障害など様々な要因によって，口腔の機能が複合的に低下している疾患です。放置しておくと咀嚼障害，摂食嚥下障害など口腔の機能障害を引き起こし，また，低栄養やフレイル、サルコペニアを進展させるなど全身の健康を損なう可能性があります。</p>
        <p>口腔機能低下症の7つの下位症状（口腔衛生状態不良，口腔乾燥，咬合力低下，舌口唇運動機能低下，低舌圧，咀嚼機能低下，嚥下機能低下）のうち，3項目以上該当する場合に口腔機能低下症と診断されます。</p>
      </div>
      
      <div class="summary-card">
        <h3>口腔機能低下症とオーラルフレイル</h3>
        <p>オーラルフレイルは、わずかなむせや食べこぼし、滑舌の低下といった口腔機能が低下した状態を示すものであり、国民の啓発に用いる用語（キャッチフレーズ）です。</p>
        <p>一方、口腔機能低下症は、検査結果に基づく疾患名です。従って、オーラルフレイルと口腔機能低下症はオーバーラップされる部分が多く、区別されるものではありません。</p>
        <p>口腔機能低下症とオーラルフレイルは、どちらも重要な概念であり、オーラルフレイルの用語を用いて国民へ口腔機能に関心を持つことの重要性を啓発していくことが重要です。その結果、国民がオーラルフレイルであると感じたら、歯科医院を訪れて口腔機能低下症の検査を受ける、ということが一般的になることが望まれます。</p>
      </div>
      
      <div class="summary-card">
        <h3>口腔機能低下症の保険診療の流れ</h3>
        <ol>
          <li>口腔機能低下症の検査・診断</li>
          <li>管理計画の立案</li>
          <li>管理計画の患者等への説明・同意</li>
          <li>口腔機能低下症の管理（患者への動機づけ，機能訓練の指導，生活指導，栄養指導など）</li>
          <li>再評価（6か月後に口腔機能精密検査を行う）</li>
          <li>継続管理</li>
        </ol>
        <p>※舌圧検査は3か月毎に実施可能です。<br>
        ※低下が2項目以下となっても継続管理可能です。</p>
      </div>
      
      <div class="summary-card">
        <h3>口腔機能低下症の管理</h3>
        <p>口腔機能低下症の管理は，口腔機能のさらなる悪化を予防し，口腔機能を維持，回復することを目的とします。</p>
        <p>管理毎に，栄養状態や口腔機能が維持・回復しているかを臨床的観点から評価を行います。そして，管理計画に基づき，患者本人と家族に対して，状況に応じた動機付け，療養上必要な機能訓練の指導や生活指導および栄養指導を実施し，管理指導記録簿に記録して保存します。</p>
        <h4>各症状の管理方法例</h4>
        <table>
          <thead>
            <tr>
              <th>症状・状態</th>
              <th>管理方法の例</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>口腔衛生状態不良</td>
              <td>
                <ul>
                  <li>歯科医師・歯科衛生士による口腔衛生管理</li>
                  <li>患者や家族等による口腔ケアの指導</li>
                  <li>適切な経口摂取の指導</li>
                </ul>
              </td>
            </tr>
            <tr>
              <td>口腔乾燥</td>
              <td>
                <ul>
                  <li>水分管理・水分補給の指導</li>
                  <li>内服薬剤の確認・医科への照会</li>
                  <li>唾液腺マッサージの指導・健口体操</li>
                  <li>口腔保湿剤の指導・加湿・ネブライザー・マスク着用等の指導</li>
                  <li>含嗽指導</li>
                </ul>
              </td>
            </tr>
            <tr>
              <td>口唇・舌の機能低下</td>
              <td>
                <ul>
                  <li>「パ」「タ」「カ」の繰り返し発音訓練の指導</li>
                  <li>口唇・舌の自動運動の指導</li>
                  <li>吹き戻し（ピロピロ笛）を用いた訓練の指導</li>
                  <li>抵抗訓練器具による訓練指導</li>
                </ul>
              </td>
            </tr>
            <tr>
              <td>咬合力・咀嚼機能の低下</td>
              <td>
                <ul>
                  <li>咬合支持の確立，義歯の製作・調整</li>
                  <li>歯周治療</li>
                  <li>咀嚼指導</li>
                  <li>食事指導，介護食，経口栄養補助食品の活用</li>
                </ul>
              </td>
            </tr>
            <tr>
              <td>嚥下機能の低下</td>
              <td>
                <ul>
                  <li>嚥下体操の指導</li>
                  <li>開口訓練</li>
                  <li>嚥下の間接訓練・直接訓練</li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div class="summary-card">
        <h3>参考資料・リンク</h3>
        <ul>
          <li>日本歯科医学会：<a href="http://www.jads.jp/basic/" target="_blank">口腔機能低下症に関する基本的な考え方</a></li>
          <li>日本老年歯科医学会：<a href="http://www.gerodontology.jp/" target="_blank">公式ホームページ</a></li>
        </ul>
      </div>
    </div>

    
    
    
    
    
  </div>